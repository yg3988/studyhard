# 모델 변환과 시점 변환

## 기하 변환

### 기하 변환

물체를 설계할 때는 물체 위치를 옮기거나 물체 모습을 변형할 필요가 있다. 이는 물체의 이동, 회전, 크기 조절 등의 작업으로, 그래픽에서는 이를 **기하 변환** 또는 줄여서 **변환** 이라고 한다.

### 이동

탄력이 없는 단단한 물체를 이동하면 물체를 구성하는 다각형 정점이동일한 양만틈 움직이는데, 이를 **이동 변환** 이라 한다.
```
P´(x´,y´) = T + P(x,y)  
x´ = x + Tx
y´ = y + Ty
```
![tmat1](https://user-images.githubusercontent.com/31890257/47606724-02908800-da52-11e8-9e24-0cc39e80f001.jpg)  

위 식은 2차원 점을 3차원 동차 좌표로 표시한 것이다. 좌변은 마지막 요소가 1이므로, 2차원 좌표 (x´, y´)에 있는 점 P′를 의미한다. 같은 맥락에서 우변 두 번째 행렬은 점P를 의미한다. 행렬의 곱셈은 해당 행의 요소와 해당 열의 요소를 곱해서 더한 것이다.

![tmat2](https://user-images.githubusercontent.com/31890257/47606725-02908800-da52-11e8-982b-a7948d53d81d.jpg)  

3차원 이동은 위 행렬로 표현할수 있다. T<sub>x</sub>, T<sub>y</sub>, T<sub>z</sub>는 각각 x, y, z축 방향으로의 이동 거리를 의미한다. 결과적으로 이동 후의 점 P´(x´,y´,z´)의 위치는 이동 행렬 T와 이동 전의 점 P(x,y,z)를 곱해서 구해진다. 좌변 행렬은 점 P′를 의미한다. 우변 둘째 행렬은 점 P를 의미한다.

우변의 이동 행렬 T는 4×4 행렬로서 대각선 요소가 모두 1인 특이한 형태다. 축 방향 의 이동 거리 T<sub>x</sub>, T<sub>y</sub>, T<sub>z</sub>는 모두 행렬의 마지막 열에 나열되고 있으며, 특히 행렬의 4행은 (0, 0, 0, 1)로 되어 있다.

### 회전

2차원에서의 회전은 원점을 중심으로 점 P가 반시계 방향으로 회전각 θ만큼 회전하는 것을 나타낸다. 원점과 점P를 연결하는 선분이 x축과 이루는 각을 Φ, 회전 반지름을 r이라 했을 때 회전 이후의 점P´(x´,y´)과 점 P(x,y)와의 관계를 동차 좌표로 표시하면 다음과 같다.  

![rmat1](https://user-images.githubusercontent.com/31890257/47606718-015f5b00-da52-11e8-83be-a6f0068cfea1.jpg)  
위 행렬식은 **2차원 회전 변환** 을 의미한다.

3차원 회전은 항상 **회전축** 을 기준으로 표현한다.

![rmat2](https://user-images.githubusercontent.com/31890257/47606719-01f7f180-da52-11e8-88e7-ecf298622682.jpg)  
z축을 기준으로 하는 회전은 다음과 같은 변환 행렬로 나타낼 수 있다.

변환 행렬이 4×4일 뿐, 식이 2차원 회전 변환과 달라진 것은 거의 없다. z축을 기준으로 한 회전이기 때문에 z´ = z로, 변환 전후를 통해 z 좌표는 같다. 유사한 맥락에서 x축과 y축을 기준으로 하는 회전은 다음과 같은 변환 행렬로 표시 된다.

![rmat3](https://user-images.githubusercontent.com/31890257/47606720-01f7f180-da52-11e8-9553-105a582446c2.jpg)  
x축 기준 회전  
![rmat4](https://user-images.githubusercontent.com/31890257/47606721-01f7f180-da52-11e8-88ec-3714cd153572.jpg)  
y축 기준 회전

### 크기 조절

**크기 조절 변환** 을 나타내는 변환 행렬을 표시하면 다음과 같다.  

![smat1](https://user-images.githubusercontent.com/31890257/47606723-02908800-da52-11e8-8337-3c726acc38ec.jpg)

여기서 S<sub>x</sub>, S<sub>y</sub>, S<sub>z</sub>는 각각 x, y, z축 방향의 배율이다. 물론 배율이 1보다 크면 확대, 작으면 축소에 해당한다. 모든 배율이 같은 경우를 **균등 크기 조절**, 하나라도 다르면 **차등 크기 조절** 이라 한다.

### 전단

**전단** 은 강체의 변환과 달리 물체 자체를 변형시킨다. 정육면체가 있다고 가정하자. 이 정육면체를 밀어낼 때 왼쪽 위 모서리에만 힘을 가하고 아래 모서리에는 힘을 가하지 않았을 경우, 정면이 평행사변형인 육면체가 만들어지는 것을 전단이라 한다. 전단을 변환 행렬로 표시하면 아래와 같이 표시된다.

![shmat1](https://user-images.githubusercontent.com/31890257/47606722-01f7f180-da52-11e8-9899-4740d39021b3.jpg)

Sh<sub>x</sub>, Sh<sub>y</sub>는 각각 x, y방향의 전단 인수를 말한다.

### 복합 변환

일반 적으로 변환은 연속적으로 가해진다. 예를 들어 물체에 대해 크기 조절(S1) 작업을 가한 후,그 결과 물체를 회전(R1)한 후에 다시 크기 조절(S2)작업을 가할 수 있다. 이 경우 새로운 점의 좌표 P´ = S2ㆍR1ㆍS1ㆍP라는 관계식으로 표시도니다. 여기서 주의할 점은 작업이 가해진 순서의 역순으로 행렬이 곱해진다는 점이다. 결합법칙이 성립하기 때문에 R1ㆍS1을 먼저 계산하든, S2ㆍR1을 먼저 계산하든 무관하다. 단지 순서만 지켜지면 된다. 연속된 변환 행렬을 모두 곱하여 하나의 행렬로 표시한 것을 복합 행렬이라 부른다. 복합 행렬을 사용하면 처리 시간이 단축된다.

복합행렬로 대변되는 일련의 연속된 변환을 **복합 변환** 이라한다. 복합 변환의 대표적인 예로 중심점 기준 회전을 들 수 있다. 중심점, 즉 피벗은 물체 내부나 외부의 임의 위치에 선택할 수 있는 것으로, 이 과정은

1. 피벗이 좌표계 원점에 일치하도록 물체를 이동한다.
2. 물체를 원점 중심으로 기준 축 주위로 회전한다.
3. 회전된 물체를 1번에서 이동한 방향의 반대 방향으로 이동한다.

수식을 표현하면 아래와 같다.

C = T(X<sub>p</sub>,Y<sub>p</sub>,Z<sub>p</sub>)ㆍR<sub>z</sub>(θ)ㆍT(-X<sub>p</sub>,-Y<sub>p</sub>,-Z<sub>p</sub>)

  (X<sub>p</sub>,Y<sub>p</sub>,Z<sub>p</sub>)은 피벗의 좌표라 했을때, 피벗을 (-X<sub>p</sub>,-Y<sub>p</sub>,-Z<sub>p</sub>)만큼 이동하여 원점과 일치키시고 R<sub>z</sub>(θ)만큼 z축 기준 변환 후 피벗의 좌표로 움직였던 만큼 반대로 움직인다.

### 변환의 분류

이동 변환, 회전 변환을 합하여 **강체 변환** 이라 한다. 이 변환은 물체 자체의 모습을 변형하는 것이 아니므로 변환 전후에 내부 정점 간의 거리가 그대로 유지 된다는 특성이 있다.(**합동**)  
강체 변환에 균등 크기 조절 변환과 반사 변환을 추가한 것을 **유사 변환** 이라 한다. 이 변환에서는 변환 전후에 물체면 사이의 각이 유지되고, 물체 내부 정점 간의 거리도 일정한 비율로 유지도니다. 결과 적으로 변환 전후의 모습이 매우 유사하다. 연속된 유사 변환의 결과도 역시 유사 변환이다. (**닮을 꼴**)

유사 변환에 차등 크기 조절 변환과 전단 변환을 추가한 것을 **어파인 변환** 이라 한다. 공학이나 자연 과학의 문제 해결에 사용되는 거의 모든 변환이 어파인 변환이다. 물체의 타입이 유지된다는 특성이 있다. 예를 들면 직선은 직선으로, 다각형은 다각형으로, 곡면은 곡면으로 유지된다. 또, 어파인 변환의 가장 큰 특징은 행렬의 마지막 행이 항상 (0, 0, 0, 1) 이라는 점이다.

평행했던 두 선분이 변환 결과 서로 만나는 경우도 있다. **원근 변환** 이라고 부르는 이러한 중류의 변환에서는 직선이 직선으로 변환된다는 정도의 속석만 유지된다. 원근 변환의 마지막 행은 어파인 변환과 달리 (0, 0, 0, 1)이 아니다. 어파인 변환과 원근 변환을 합쳐서 선형 변환이라 부른다.
